select name,status from dba_ols_status where name='OLS_CONFIGURE_STATUS';
--select * from DBA_SA_Policies;

EXECUTE SA_SYSDBA.DROP_POLICY('ACCESS_THONGBAO');

EXECUTE SA_SYSDBA.CREATE_POLICY('ACCESS_THONGBAO','OLS_THONGBAO');



GRANT EXECUTE ON SA_COMPONENTS TO CSYT_ADMIN;

GRANT EXECUTE ON SA_LABEL_ADMIN TO CSYT_ADMIN;

GRANT EXECUTE ON SA_POLICY_ADMIN TO CSYT_ADMIN;

GRANT EXECUTE ON SA_USER_ADMIN TO CSYT_ADMIN;

GRANT EXECUTE ON CHAR_TO_LABEL TO CSYT_ADMIN;


--level: Giám đốc
--compartment: ngoại trú
--group: trung/cận trung/ ngoại

EXEC SA_COMPONENTS.CREATE_LEVEL('ACCESS_THONGBAO',9000,'GDS','GIAM_DOC_SO');
EXEC SA_COMPONENTS.CREATE_LEVEL('ACCESS_THONGBAO',8000,'GDCS','GIAM_DOC_CSYT');
EXEC SA_COMPONENTS.CREATE_LEVEL('ACCESS_THONGBAO',7000,'YBS','Y_BSI');


EXEC SA_COMPONENTS.CREATE_COMPARTMENT('ACCESS_THONGBAO',100,'CS','CHUYEN_SAU');
EXEC SA_COMPONENTS.CREATE_COMPARTMENT('ACCESS_THONGBAO',200,'NT','NOI_TRU');
EXEC SA_COMPONENTS.CREATE_COMPARTMENT('ACCESS_THONGBAO',300,'NGT','NGOAI_TRU');


EXEC SA_COMPONENTS.CREATE_GROUP('ACCESS_THONGBAO',1,'TT','TRUNG_TAM');
EXEC SA_COMPONENTS.CREATE_GROUP('ACCESS_THONGBAO',2,'CTT','CAN_TRUNG_TAM');
EXEC SA_COMPONENTS.CREATE_GROUP('ACCESS_THONGBAO',3,'NT','NGOAI_THANH');


--LV ONNLY
EXEC SA_LABEL_ADMIN.CREATE_LABEL(policy_name => 'ACCESS_THONGBAO',label_tag => 1,label_value => 'QL');

EXEC SA_LABEL_ADMIN.CREATE_LABEL('ACCESS_THONGBAO',300,'HS:TC,TT');
EXEC SA_LABEL_ADMIN.CREATE_LABEL('ACCESS_THONGBAO',300,'HS:TC:PKD');


EXEC SA_POLICY_ADMIN.APPLY_TABLE_POLICY('ACCESS_THONGBAO','QLNV','NHANVIEN','NO_CONTROL');


GRANT SELECT, INSERT, UPDATE ON ANNOUCEMENTS TO QLNV;

UPDATE QLNV.NHANVIEN

SET OLS_NHANVIEN = CHAR_TO_LABEL('ACCESS_THONGBAO','HS');


EXEC SA_USER_ADMIN.SET_LEVELS ('ACCESS_THONGBAO','QUANLY','EXEC','EMP','EXEC','EXEC');
EXEC SA_USER_ADMIN.SET_COMPARTMENTS('ACCESS_THONGBAO','QUANLY','SALES,DEV,IS','SALES,DEV,IS','SALES,DEV,IS','SALES,DEV,IS',);



